<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pro Max Sizzu DP Gallery</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="site-header">
    <img src="assets/cover.jpg" alt="Cover Photo" class="cover-photo" />
    <h1>Pro Max Sizzu DP Gallery</h1>
  </header>

  <section class="upload-section">
    <input type="file" id="fileInput" multiple accept="image/*" />
    <button id="uploadBtn">Upload Photos</button>
  </section>

  <section id="gallery" class="gallery"></section>

  <script>
    async function uploadPhotos(files) {
      const formData = new FormData();
      for (const file of files) formData.append('photos', file);

      try {
        const res = await fetch('/upload', {
          method: 'POST',
          body: formData
        });
        const data = await res.json();
        alert(`Uploaded ${data.uploaded.length} photos.`);
        fetchGallery();
      } catch (err) {
        alert('Upload failed: ' + err);
      }
    }

    async function fetchGallery() {
      try {
        const res = await fetch('/gallery');
        const data = await res.json();
        const gallery = document.getElementById('gallery');
        gallery.innerHTML = '';
        data.photos.forEach(src => {
          const div = document.createElement('div');
          div.classList.add('photo-box');
          const img = document.createElement('img');
          img.src = src;
          img.classList.add('photo');
          img.alt = 'Gallery Photo';
          div.appendChild(img);
          gallery.appendChild(div);
        });
      } catch (err) {
        console.error('Failed to fetch gallery', err);
      }
    }

    document.getElementById('uploadBtn').addEventListener('click', () => {
      const files = document.getElementById('fileInput').files;
      if (!files.length) return alert('Select photos first');
      uploadPhotos(files);
    });

    window.onload = fetchGallery;
  </script>
</body>
</html>
